* [4.1 数据清洗](#41-数据清洗)
    * [4.1.1 缺失值处理](#411-缺失值处理)

## chapter4 数据预处理
1. 预处理 = 数据清洗 + 数据集成 + 数据转换 + 数据规约
2. 在数据挖掘的过程中，数据预处理工作量占到了整个过程的60%

### 4.1 数据清洗
1. 任务：删除原数据集中的无关数据、重复数据，平滑噪声数据，筛选与挖掘主题无关的数据，处理缺失值、异常值

#### 4.1.1 缺失值处理
1. 处理方法：**删除记录、数据插补、不处理**
2. 常见数据插补方法：

| 插补方法 | 方法描述 |
| :---: | :---: |
| 均值/中位数/众数 | 根据属性值的类型，用该属性取值的平均值/中位数/众数进行插补 |
| 固定值 | 将缺失的值用一个常量替换 |
| 最近邻 | 在记录中找到与缺失样本最接近的样本的该属性值插补 |
| 回归方法 | 对带有缺失值的变量，根据已有的数据和与其有关的其它变量（因变量）的数据建立拟合模型来预测缺失的属性值 |
| 插值法 | 利用已知点建立合适的差值函数 $f(x)$，未知值由对应点 $x$ 求出的函数值 $f(x)$ 近似代替

3. 插值法
    - 拉格朗日插值和牛顿插值，本质上其结果是一样的，只是表示形式不同。而后者相对于前者而言，具有承袭性和易于变动节点的特点
    - 拉格朗日插值法：已知平面上 $n$ 个点可以找到一个 $n-1$ 次多项式 $y=a_0+a_1x+a_2x^2+\cdots+a_{n-1}x^{n-1}$，使得多项式可以过这 $n$ 个点。
        - 推导过程：
            1. 设函数：$y=a_0+a_1x+a_2x^2+\cdots+a_{n-1}x^{n-1}$
            2. 将已知的 $n$ 个点代入该方程得：
            $$
                \begin{cases}
                y_1=a_0+a_1x_1+a_2x_1^2+\cdots+a_{n-1}x_1^{n-1} \\
                y_2=a_0+a_1x_2+a_2x_2^2+\cdots+a_{n-1}x_2^{n-1} \\
                \cdots \\
                y_n=a_0+a_1x_n+a_2x_n^2+\cdots+a_{n-1}x_n^{n-1}
                \end{cases}
            $$
            解出拉格朗日插值多项式为
            $$
                \begin{array}{l}
                L(x)=y_1\frac{(x-x_2)(x-x_3)\cdots(x-x_n)}{(x_1-x_2)(x_1-x_3)\cdots(x_1-x_n)} \\
                \\+ y_2\frac{(x-x_1)(x-x_3)\cdots(x-x_n)}{(x_2-x_1)(x_2-x_3)\cdots(x_2-x_n)} \\
                \\+ \cdots \\
                \\+ y_n\frac{(x-x_1)(x-x_2)\cdots(x-x_{n-1})}{(x_n-x_1)(x_n-x_2)\cdots(x_n-x_{n-1})} \\
                = \sum_{i=0}^ny_i\prod_{j=0,j \neq i}^n\frac{x-x_j}{x_i-x_j}
                \end{array}
            $$
        - 使用方法：将缺失的函数值对应的点 $x$ 代入到拉格朗日插值多项式就可以得到带缺失值的近似值 $L(x)$，然后用该值来近似替代对应的未知值
        - 缺点：在实际中，当插值节点增减时，拉格朗日插值多项式就会变化，需要重新求解，很不方便。牛顿插值法则用于克服这一问题
    - 牛顿插值法：
        - 推导过程：
            1. 求已知的 $n$ 个点对 $(x_1,y_1),(x_2,y_2),\cdots,(x_n,y_n)$ 的所有阶差商公式
            $$
                \begin{matrix}
                f[x_1,x]=\frac{f[x]-f[x_1]}{x-x_1}=\frac{f(x)-f(x_1)}{x-x_1}
                \end{matrix}
            $$
            $$
                \begin{matrix}
                f[x_2,x_1,x]=\frac{f[x_1]-f[x]}{x-x_2}
                \end{matrix}
            $$
            $$
                \begin{matrix}
                f[x_3,x_2,x_1,x]=\frac{f[x_2,x_1,x]-f[x_3,x_2,x_1]}{x-x_3}
                \end{matrix}
            $$
            $$\cdots$$
            $$
                \begin{matrix}
                f[x_n,x_{n-1},\cdots,x_1,x]=\frac{f[x_{n-1},\cdots,x_1,x]-f[x_n,\cdots,x_1]}{x-x_n}
                \end{matrix}
            $$
            2. 联立以上差商公式建立如下插值多项式 $f(x)$
            $$
                \begin{array}{l}
                f(x)=f(x_1)+(x-x_1)f[x_2,x_1]+(x-x_1)(x-x_2)f[x_3,x_2,x_1]+ \\
                (x-x_1)(x-x_2)(x-x_3)f[x_4,x_3,x_2,x_1]+\cdots+ \\
                (x-x_1)(x-x_2)\cdots(x-x_{n-1})f[x_n,\cdots,x_1] + \\
                (x-x_1)(x-x_2)\cdots(x-x_n)f[x_n,\cdots,x_1,x] \\
                =P(x)+R(x)
                \end{array}
            $$
            其中
            $$
                \begin{array}{l}
                P(x)=f(x_1)+(x-x_1)f[x_2,x_1]+(x-x_1)(x-x_2)f[x_3,x_2,x_1]+ \\
                (x-x_1)(x-x_2)(x-x_3)f[x_4,x_3,x_2,x_1]+\cdots+ \\
                (x-x_1)(x-x_2)\cdots(x-x_{n-1})f[x_n,\cdots,x_1] \\
                \\
                R(x)=(x-x_1)(x-x_2)\cdots(x-x_n)f[x_n,\cdots,x_1,x]
                \end{array}
            $$
            $P(x)$ 是牛顿插值逼近函数，$R(x)$ 是误差函数
        - 使用方法：将缺失的函数值对应的点带入插值多项式得到缺失值的近似值 $f(x)$
    - [相关代码](code/lagrange_interp.py)